"use strict";(()=>{var e={};e.id=483,e.ids=[483],e.modules={3524:e=>{e.exports=require("@prisma/client")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4770:e=>{e.exports=require("crypto")},2048:e=>{e.exports=require("fs")},9801:e=>{e.exports=require("os")},5315:e=>{e.exports=require("path")},5449:(e,t,a)=>{a.r(t),a.d(t,{originalPathname:()=>S,patchFetch:()=>I,requestAsyncStorage:()=>N,routeModule:()=>d,serverHooks:()=>p,staticGenerationAsyncStorage:()=>R});var r={};a.r(r),a.d(r,{GET:()=>T,runtime:()=>O});var n=a(261),i=a(8331),o=a(4510),_=a(9784),E=a(2942),s=a(7151);let O="nodejs",u=e=>{let t=e.headers.get("authorization"),a=t?.startsWith("Bearer ")?t.slice(7):null,r=e.headers.get("x-internal-secret");return a===E.O.internalSecret||r===E.O.internalSecret},l=e=>{let t=e.headers.get("x-vercel-id");return t&&t.split("::")[0]||"unknown"};async function T(e){if(!u(e))return _.NextResponse.json({ok:!1},{status:401});let t=new Date().toISOString(),a=l(e);try{return await s._.$queryRaw`SELECT 1`,_.NextResponse.json({ok:!0,ts:t,region:a,db:"ok"})}catch(e){return _.NextResponse.json({ok:!1,ts:t,region:a,db:"error"},{status:500})}}let d=new n.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/internal/health/route",pathname:"/api/internal/health",filename:"route",bundlePath:"app/api/internal/health/route"},resolvedPagePath:"/Users/ilias_iangurazov/Desktop/telegram-shift-bot/src/app/api/internal/health/route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:N,staticGenerationAsyncStorage:R,serverHooks:p}=d,S="/api/internal/health/route";function I(){return(0,o.patchFetch)({serverHooks:p,staticGenerationAsyncStorage:R})}},2942:(e,t,a)=>{a.d(t,{O:()=>o}),a(4243);var r=a(7012);let n=r.dj(e=>{if("string"==typeof e){let t=e.trim().toLowerCase();if(["true","1","yes","y","on"].includes(t))return!0;if(["false","0","no","n","off",""].includes(t))return!1}return e},r.O7()),i=r.Ry({TELEGRAM_BOT_TOKEN:r.Z_().min(1),TELEGRAM_BOSS_CHAT_ID:r.Z_().min(1),ADMIN_USER_IDS:r.Z_().optional(),DATABASE_URL:r.Z_().min(1),WEBHOOK_SECRET:r.Z_().min(1),INTERNAL_SECRET:r.Z_().min(1),PUBLIC_BASE_URL:r.Z_().min(1),TELEGRAM_WEBHOOK_SECRET_TOKEN:r.Z_().optional(),TIMEZONE:r.Z_().default("Asia/Bishkek"),MAX_SHIFT_HOURS:r.oQ.number().int().positive().default(12),MIN_SHIFT_HOURS:r.oQ.number().int().positive().default(8),SHORT_SHIFT_GRACE_MINUTES:r.oQ.number().int().min(0).default(0),PENDING_ACTION_TTL_MINUTES:r.oQ.number().int().positive().default(10),PENDING_ACTION_CLEANUP_CRON:r.Z_().default("*/2 * * * *"),PHOTO_RETENTION_DAYS:r.oQ.number().int().positive().default(3),PHOTO_RETENTION_CRON:r.Z_().default("0 * * * *"),OVERDUE_CHECK_CRON:r.Z_().default("*/5 * * * *"),TICK_MAX_AUTOCLOSE:r.oQ.number().int().positive().default(50),TICK_MAX_EXPIRE_PENDING:r.oQ.number().int().positive().default(200),NOTIFY_EMPLOYEE_ON_AUTOCLOSE:n.default(!0),ERROR_NOTIFY_BOSS:n.default(!1),ERROR_NOTIFY_COOLDOWN_SEC:r.oQ.number().int().positive().default(60),EVENT_LOG_RETENTION_DAYS:r.oQ.number().int().positive().default(14),LOG_LEVEL:r.Z_().default("info"),NODE_ENV:r.Z_().optional()}).safeParse(process.env);if(!i.success){let e=i.error.format();throw Error(`Invalid environment configuration: ${JSON.stringify(e)}`)}let o={telegramBotToken:i.data.TELEGRAM_BOT_TOKEN,telegramBossChatId:i.data.TELEGRAM_BOSS_CHAT_ID,adminUserIds:(i.data.ADMIN_USER_IDS??"").split(",").map(e=>e.trim()).filter(Boolean),databaseUrl:i.data.DATABASE_URL,webhookSecret:i.data.WEBHOOK_SECRET,internalSecret:i.data.INTERNAL_SECRET,publicBaseUrl:i.data.PUBLIC_BASE_URL,telegramWebhookSecretToken:i.data.TELEGRAM_WEBHOOK_SECRET_TOKEN??null,timezone:i.data.TIMEZONE,maxShiftHours:i.data.MAX_SHIFT_HOURS,minShiftHours:i.data.MIN_SHIFT_HOURS,shortShiftGraceMinutes:i.data.SHORT_SHIFT_GRACE_MINUTES,pendingActionTtlMinutes:i.data.PENDING_ACTION_TTL_MINUTES,pendingActionCleanupCron:i.data.PENDING_ACTION_CLEANUP_CRON,photoRetentionDays:i.data.PHOTO_RETENTION_DAYS,photoRetentionCron:i.data.PHOTO_RETENTION_CRON,overdueCheckCron:i.data.OVERDUE_CHECK_CRON,tickMaxAutoclose:i.data.TICK_MAX_AUTOCLOSE,tickMaxExpirePending:i.data.TICK_MAX_EXPIRE_PENDING,notifyEmployeeOnAutoClose:i.data.NOTIFY_EMPLOYEE_ON_AUTOCLOSE,errorNotifyBoss:i.data.ERROR_NOTIFY_BOSS,errorNotifyCooldownSec:i.data.ERROR_NOTIFY_COOLDOWN_SEC,eventLogRetentionDays:i.data.EVENT_LOG_RETENTION_DAYS,logLevel:i.data.LOG_LEVEL,nodeEnv:i.data.NODE_ENV}},7151:(e,t,a)=>{a.d(t,{_:()=>n});var r=a(3524);let n=globalThis.prisma??new r.PrismaClient}};var t=require("../../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[937,830],()=>a(5449));module.exports=r})();